<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vinbot ‚Äì din personlige vinassistent</title>
  <meta name="description" content="Find den perfekte vin p√• sekunder. S√∏g efter drue, land, mad eller hum√∏r ‚Äì Vinbot guider dig til de bedste k√∏b." />

  <!-- Google Analytics (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXX'); // ‚Üê inds√¶t dit GA4-id
  </script>

  <style>
    :root{
      --bg: #0f0e10;
      --fg: #f4efe9;
      --muted: #cfc7bd;
      --card: rgba(255,255,255,0.07);
      --cardBorder: rgba(255,255,255,0.15);
      --accent: #e63b3b; /* moden r√∏d */
      --accent-2: #ff8a4c; /* varm orange til grad */
      --glow: 0 10px 30px rgba(230,59,59,0.35);
      --radius-lg: 18px;
      --radius-sm: 12px;
      --shadow-sm: 0 1px 2px rgba(0,0,0,.2);
      --shadow-lg: 0 12px 40px rgba(0,0,0,.45);
    }
    *{ box-sizing: border-box }
    html,body{ height:100% }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "SF Pro Text", Arial, sans-serif;
      color:var(--fg);
      background:
        radial-gradient(1200px 500px at 10% -10%, rgba(230,59,59,.25), transparent 60%),
        radial-gradient(1200px 600px at 110% 10%, rgba(255,138,76,.22), transparent 65%),
        linear-gradient(180deg, #121114 0%, #0b0a0c 100%);
    }

    /* Header / hero */
    .nav{
      max-width:1100px; margin:0 auto; padding:20px 20px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .brand{
      display:flex; align-items:center; gap:12px; text-decoration:none; color:var(--fg);
    }
    .brand-logo{
      width:36px; height:36px; border-radius:10px;
      display:grid; place-items:center;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: var(--glow);
      font-weight:700;
    }
    .brand h1{ font-size:20px; margin:0; letter-spacing:.2px }

    .hero{
      max-width:1100px; margin:36px auto 24px; padding:0 20px;
      text-align:center;
    }
    .hero h2{
      margin:0 0 10px;
      font-size: clamp(28px, 6vw, 56px);
      line-height:1.05;
      letter-spacing: -.5px;
    }
    .hero p{
      margin:0 auto 26px; max-width:760px;
      color:var(--muted); font-size: clamp(16px, 2.3vw, 18px);
    }

    /* Search */
    .search-wrap{
      max-width:900px; margin: 26px auto 10px; padding: 10px;
      border-radius: var(--radius-lg);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--cardBorder);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(8px);
    }
    .search{
      display:flex; align-items:center; gap:12px;
      background: rgba(0,0,0,.25); border-radius: 14px; padding: 8px 10px;
      border:1px solid rgba(255,255,255,.08);
    }
    .search .icon{ opacity:.7; padding-left:8px }
    .search input{
      flex:1; border:0; outline: none; background: transparent; color: var(--fg);
      font-size: clamp(16px, 2.4vw, 20px); padding: 12px 2px;
    }
    .search button{
      border:0; padding:12px 16px; cursor:pointer; color:white;
      border-radius:12px; background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: var(--glow);
      font-weight: 700;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .search button:hover{ transform: translateY(-1px); box-shadow: 0 12px 26px rgba(230,59,59,0.4) }
    .chips{
      display:flex; gap:10px; flex-wrap: wrap; margin-top:12px;
      justify-content:center;
    }
    .chip{
      border:1px solid var(--cardBorder); background: var(--card);
      padding:8px 12px; border-radius:999px; font-size:14px; color:var(--fg);
      cursor:pointer; transition: background .12s, transform .12s; user-select:none;
    }
    .chip:hover{ background: rgba(255,255,255,.14); transform: translateY(-1px) }

    /* Results grid */
    .wrap{
      max-width:1100px; margin: 24px auto 80px; padding:0 20px;
    }
    .grid{
      display:grid; gap:16px;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    }
    .card{
      display:block; text-decoration:none; color:inherit;
      background: var(--card);
      border: 1px solid var(--cardBorder);
      border-radius: var(--radius-lg);
      padding:16px;
      box-shadow: var(--shadow-sm);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.28);
      box-shadow: var(--shadow-lg);
    }
    .card h3{ margin:0 0 8px; font-size:18px; letter-spacing:.2px }
    .badges{ display:flex; gap:8px; flex-wrap:wrap }
    .badge{
      font-size:12px; color:#f7f2ec; background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.16);
      padding:6px 8px; border-radius: 999px;
    }

    /* Footer */
    footer{
      color: #a99f95; text-align:center; padding:26px 20px 60px;
      font-size: 13px;
    }

    /* focus-visible for a11y */
    .card:focus-visible, .chip:focus-visible, .search input:focus-visible, .search button:focus-visible{
      outline: 2px solid #ffffff; outline-offset: 3px;
    }
  </style>
</head>
<body>
  <nav class="nav">
    <a class="brand" href="/">
      <div class="brand-logo">üç∑</div>
      <h1>Vinbot</h1>
    </a>
  </nav>

  <header class="hero">
    <h2>Find vin p√• sekunder</h2>
    <p>Fort√¶l hvad du er i hum√∏r til ‚Äì <strong>drue</strong>, <strong>mad</strong>, <strong>pris</strong> eller <strong>lejlighed</strong>. Vinbot guider dig til de bedste butikker.</p>

    <div class="search-wrap">
      <div class="search">
        <div class="icon">üîé</div>
        <input id="q" placeholder="fx ‚Äúbarolo til b√∏f under 150 kr‚Äù eller ‚Äúsushi og sommer‚Äù" autocomplete="off" autofocus />
        <button id="searchBtn">S√∏g</button>
      </div>
      <div class="chips" id="chips">
        <span class="chip" data-q="barolo til b√∏f under 150 kr">Barolo ¬∑ b√∏f ¬∑ &lt;150</span>
        <span class="chip" data-q="chianti til pizza">Chianti ¬∑ pizza</span>
        <span class="chip" data-q="sauvignon blanc til sushi">Sauvignon Blanc ¬∑ sushi</span>
        <span class="chip" data-q="ros√© terrasse under 100 kr">Ros√© ¬∑ terrasse ¬∑ &lt;100</span>
        <span class="chip" data-q="riesling til ostebord">Riesling ¬∑ ost</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid" id="results" aria-live="polite"></section>
  </main>

  <footer>
    Annonce- og affiliate-disclaimer: Vi kan modtage kommission via links. ü§ù
  </footer>

  <script>
    // ---- KONFIG ----
    // N√•r du vil aktivere din /out-redirect senere: s√¶t USE_REDIRECT=true og just√©r OUT_BASE.
    const USE_REDIRECT = false;
    const OUT_BASE = "/out/"; // fx "https://vinbot.dk/out/"
    // Forhandlere (udvid senere + kommission/EPC n√•r vi vil v√¶gte)
    const MERCHANTS = [
      { name: "Jysk Vin", host: "jyskvin.dk", search: "https://jyskvin.dk/search?q={Q}" },
      { name: "Beer Me",  host: "beerme.dk",  search: "https://beerme.dk/soeg?q={Q}" },
      // { name: "VildMedVin", host: "vildmedvin.dk", search: "https://vildmedvin.dk/search?q={Q}" },
    ];

    // ---- SIMPLE ORDB√òGER / SYNONYMER ----
    const MAP = {
      druer: {
        "barolo":"nebbiolo","nebbiolo":"nebbiolo","pinot noir":"pinot noir","pinot":"pinot noir",
        "chianti":"sangiovese","sangiovese":"sangiovese","primitivo":"primitivo",
        "sauvignon blanc":"sauvignon blanc","riesling":"riesling","chardonnay":"chardonnay",
        "syrah":"syrah","shiraz":"syrah","malbec":"malbec","barbera":"barbera","tempranillo":"tempranillo",
        "rioja":"tempranillo","ribera":"tempranillo","albari√±o":"albari√±o","albarino":"albari√±o",
        "cr√©mant":"cr√©mant","cremant":"cr√©mant","ros√©":"ros√©","rose":"ros√©","chablis":"chardonnay"
      },
      mad: {
        "b√∏f":["nebbiolo","cabernet","syrah"], "oksek√∏d":["cabernet","syrah","barolo"],
        "pizza":["chianti","primitivo","barbera"], "tapas":["rioja","garnacha","cava"],
        "sushi":["riesling","sauvignon blanc","cr√©mant"], "fisk":["riesling","chablis","albari√±o"],
        "lam":["syrah","ribera","chianti"], "ost":["riesling","portvin","chardonnay"]
      }
    };

    // ---- LOGIK ----
    function parseQuery(text){
      const q = (text||"").toLowerCase();
      const out = { druer:new Set(), mad:null, max:null, mood:null, raw:q.trim() };

      Object.keys(MAP.druer).forEach(k => { if (q.includes(k)) out.druer.add(MAP.druer[k]); });
      Object.keys(MAP.mad).forEach(k => { if (q.includes(k)) out.mad = k; });

      // pris: "under 150 kr" eller bare "150 kr"
      const m = q.match(/under\s*(\d+)\s*kr|(\d+)\s*kr/);
      if (m){ const n = parseInt(m[1]||m[2],10); if (!isNaN(n)) out.max = n; }
      if (q.includes("billig") || q.includes("budget")) out.max = Math.min(out.max||9999, 100);

      if (q.includes("sommer") || q.includes("terrasse")) out.mood = "sommer";
      if (q.includes("hygge")) out.mood = "hygge";
      if (q.includes("romantisk")) out.mood = "romantisk";

      if (!out.druer.size && !out.mad && out.raw) out.druer.add(out.raw);
      return out;
    }

    function buildTarget(merchant, keyword){
      const target = merchant.search.includes("{Q}")
        ? merchant.search.replace("{Q}", encodeURIComponent(keyword))
        : merchant.search;
      if (!USE_REDIRECT) return target;
      const u = new URL(OUT_BASE, location.origin);
      u.searchParams.set("to", target);
      u.searchParams.set("subid", "search-"+Date.now());
      return u.toString();
    }

    function createIdeas(text){
      const f = parseQuery(text);
      const keys = [];
      if (f.mad && MAP.mad[f.mad]) keys.push(...MAP.mad[f.mad].slice(0,2));
      if (f.druer.size) keys.push(...Array.from(f.druer).slice(0,2));
      if (!keys.length && f.raw) keys.push(f.raw);

      // TODO senere: v√¶gt efter kommission/EPC
      const ideas = [];
      for (const kw of keys){
        for (const m of MERCHANTS){
          ideas.push({
            title: `${kw} hos ${m.name}`,
            href: buildTarget(m, kw),
            badges: [f.mad?`Mad: ${f.mad}`:null, f.max?`Under ${f.max} kr`:null, f.mood?`${f.mood}`:null].filter(Boolean)
          });
        }
      }
      return ideas.slice(0, 9);
    }

    // ---- RENDER ----
    const $q = document.getElementById('q');
    const $btn = document.getElementById('searchBtn');
    const $res = document.getElementById('results');

    function render(items){
      $res.innerHTML = items.length
        ? items.map(i => `
          <a class="card outbound" href="${i.href}" rel="nofollow sponsored" target="_blank" data-label="${i.title}">
            <h3>${i.title}</h3>
            <div class="badges">${i.badges.map(b=>`<span class="badge">${b}</span>`).join('')}</div>
          </a>
        `).join('')
        : `<div style="opacity:.75;text-align:center;padding:26px 0;">Skriv fx <em>‚Äúbarolo til b√∏f under 150 kr‚Äù</em> eller v√¶lg en chip ovenfor.</div>`;
    }

    function update(){ render(createIdeas($q.value)); }

    $q.addEventListener('input', update);
    $btn.addEventListener('click', update);
    document.getElementById('chips').addEventListener('click', e=>{
      const chip = e.target.closest('.chip'); if(!chip) return;
      $q.value = chip.dataset.q; update();
    });

    // GA4 outbound-click event
    document.addEventListener('click', (e)=>{
      const a = e.target.closest('a.outbound'); if(!a) return;
      try {
        gtag('event', 'outbound_click', {
          event_category: 'affiliate',
          event_label: a.dataset.label || a.href
        });
      } catch(_) {}
    });

    // init
    update();
  </script>
</body>
</html>
