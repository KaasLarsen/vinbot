<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vinbot ‚Äì din personlige vinassistent</title>
  <meta name="description" content="Find den rigtige vin p√• sekunder. S√∏g efter drue, land, mad eller hum√∏r ‚Äì Vinbot guider dig." />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif;margin:0;background:#faf7f5;color:#222;}
    header{padding:64px 16px;text-align:center}
    h1{font-size: clamp(28px, 4vw, 44px);margin:0 0 12px}
    p.lead{font-size: clamp(16px, 2.3vw, 20px);opacity:.85;margin:0 0 24px}
    .search{max-width:820px;margin:16px auto;display:flex;gap:8px;padding:0 16px}
    .search input{flex:1;font-size:20px;padding:16px 18px;border-radius:14px;border:1px solid #ddd;background:#fff;outline:none}
    .grid{max-width:980px;margin:24px auto 56px;display:grid;gap:14px;padding:0 16px;grid-template-columns:repeat(auto-fill,minmax(240px,1fr))}
    .card{display:block;padding:14px;border-radius:14px;border:1px solid #e9e3df;background:white;text-decoration:none;color:inherit}
    .card h3{margin:0 0 6px;font-size:18px}
    .pill{display:inline-block;font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid #e6e0dc;background:#fcfbfa;margin-right:6px}
    footer{padding:24px;color:#6b6059;font-size:13px;text-align:center}
  </style>
</head>
<body>
  <header>
    <h1>Vinbot</h1>
    <p class="lead">S√∏g vin efter <b>drue</b>, <b>land</b>, <b>mad</b> eller <b>hum√∏r</b> ‚Äì vi foresl√•r de bedste steder at starte.</p>
    <div class="search">
      <input id="q" placeholder="fx ‚Äúbarolo til b√∏f under 150 kr‚Äù eller ‚Äúsushi og sommer‚Äù" autofocus />
    </div>
    <div id="chips" aria-label="hurtige genveje" style="margin-top:8px">
      <span class="pill" data-q="barolo til b√∏f under 150 kr">Barolo ¬∑ b√∏f ¬∑ <150</span>
      <span class="pill" data-q="chianti til pizza">Chianti ¬∑ pizza</span>
      <span class="pill" data-q="sauvignon blanc til sushi">Sauvignon Blanc ¬∑ sushi</span>
      <span class="pill" data-q="ros√© til terrasse under 100 kr">Ros√© ¬∑ terrasse ¬∑ <100</span>
    </div>
  </header>

  <section class="grid" id="results" aria-live="polite"></section>

  <footer>
    <div>Annonce- og affiliate-disclaimer: Vi kan modtage kommission via links. üç∑</div>
  </footer>

  <script>
    // ---- KONFIG (midlertidig) ----
    // N√•r du senere vil aktivere din /out-redirector, s√¶t USE_REDIRECT=true og angiv OUT_BASE.
    const USE_REDIRECT = false;
    const OUT_BASE = "/out/"; // fx "https://vinbot.dk/out/"

    // Dine forhandlere (vi kan tilf√∏je flere og kommission senere)
    const MERCHANTS = [
      { name: "Jysk Vin", host: "jyskvin.dk", search: "https://jyskvin.dk/search?q={Q}" },
      { name: "Beer Me", host: "beerme.dk",  search: "https://beerme.dk/soeg?q={Q}" },
      // { name: "VildMedVin", host: "vildmedvin.dk", search: "https://vildmedvin.dk/search?q={Q}" },
    ];

    // Simple ordb√∏ger/synonymer (kan udvides l√∏bende)
    const MAP = {
      druer: {
        "barolo":"nebbiolo","nebbiolo":"nebbiolo","pinot noir":"pinot noir","chianti":"sangiovese",
        "sauvignon blanc":"sauvignon blanc","riesling":"riesling","chardonnay":"chardonnay","malbec":"malbec","syrah":"syrah","shiraz":"syrah"
      },
      mad: {
        "b√∏f":["nebbiolo","cabernet","syrah"], "oksek√∏d":["cabernet","syrah","barolo"],
        "pizza":["chianti","primitivo","barbera"], "tapas":["rioja","garnacha","cava"],
        "sushi":["riesling","sauvignon blanc","cr√©mant"], "fisk":["riesling","chablis","albari√±o"]
      }
    };

    function parseQuery(text){
      const q = (text||"").toLowerCase();
      const out = { druer:new Set(), mad:null, max:null, mood:null, raw:q };

      // drue/region-baseret n√∏gler
      Object.keys(MAP.druer).forEach(k => { if (q.includes(k)) out.druer.add(MAP.druer[k]); });

      // mad
      Object.keys(MAP.mad).forEach(k => { if (q.includes(k)) out.mad = k; });

      // pris
      const m = q.match(/under\s*(\d+)\s*kr|(\d+)\s*kr/);
      if (m){ const n = parseInt(m[1]||m[2],10); if (!isNaN(n)) out.max = n; }

      // hum√∏r/lejlighed (kan udvides)
      if (q.includes("sommer") || q.includes("terrasse")) out.mood = "sommer";
      if (q.includes("hygge")) out.mood = "hygge";
      if (q.includes("romantisk")) out.mood = "romantisk";

      // hvis brugeren intet skriver specifikt, brug hele teksten som s√∏geord
      if (!out.druer.size && !out.mad) out.druer.add(q.trim());
      return out;
    }

    function buildTarget(merchant, keyword){
      const target = merchant.search.includes("{Q}")
        ? merchant.search.replace("{Q}", encodeURIComponent(keyword))
        : merchant.search; // kategori fallback
      if (!USE_REDIRECT) return target;
      const u = new URL(OUT_BASE, location.origin);
      u.searchParams.set("to", target);
      u.searchParams.set("subid", "search-"+Date.now());
      return u.toString();
    }

    function suggest(text){
      const f = parseQuery(text);
      const keywords = [];
      if (f.mad && MAP.mad[f.mad]) keywords.push(...MAP.mad[f.mad].slice(0,2));
      if (f.druer.size) keywords.push(...Array.from(f.druer).slice(0,2));
      if (!keywords.length && f.raw) keywords.push(f.raw);

      // V√¶gtning kan senere tage h√∏jde for kommission/EPC
      const merchants = MERCHANTS.slice(0, 4);
      const ideas = [];
      for (const kw of keywords){
        for (const m of merchants){
          ideas.push({
            title: `${kw} hos ${m.name}`,
            href: buildTarget(m, kw),
            badges: [f.mad?`Mad: ${f.mad}`:null, f.max?`Under ${f.max} kr`:null, f.mood?`${f.mood}`:null].filter(Boolean)
          });
        }
      }
      return ideas.slice(0, 8);
    }

    const $q = document.getElementById('q');
    const $res = document.getElementById('results');
    function render(items){
      $res.innerHTML = items.map(i => `
        <a class="card" href="${i.href}" rel="nofollow sponsored" target="_blank">
          <h3>${i.title}</h3>
          <div>${i.badges.map(b=>`<span class="pill">${b}</span>`).join(' ')}</div>
        </a>
      `).join('') || `<div style="opacity:.7;text-align:center">Skriv fx ‚Äúbarolo til b√∏f under 150 kr‚Äù</div>`;
    }

    $q.addEventListener('input', e => render(suggest(e.target.value)));
    document.getElementById('chips').addEventListener('click', e=>{
      const pill = e.target.closest('[data-q]'); if(!pill) return;
      $q.value = pill.dataset.q; render(suggest($q.value));
    });

    // F√∏rste indl√¶sning
    render(suggest(""));
  </script>
</body>
</html>
